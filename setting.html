<!DOCTYPE html>
<html>
<head>
	<title>Mon réseau social - Connexion</title>
	<link rel="stylesheet" href="pageProfil.css">
</head>
<body>
    <a href="#menu" id="toggle" title="Profil"><span><img id="profilPicture" height="43" width="43" src="https://yt3.ggpht.com/yti/AHXOFjVaO57NZn54rIPF3EiXicYHFBWo9njQoXChDGt6EQ=s88-c-k-c0x00ffffff-no-rj-mo"></span></a>

	<div id="menu">
        <ul>
            <li><a href="https://flotix8.github.io/SocialNetwork/page_de_inscription.html" id="loginText">Login</a></li>
            <li><a href="https://flotix8.github.io/SocialNetwork/account.html">Account</a></li>
            <li><a href="https://flotix8.github.io/SocialNetwork/pageProfil.html">Home</a></li>
            <li><a href="#contact">Contact</a></li>
        </ul>
	</div>

    <!-- Formulaire pour modifier la couleur -->
	<form id="color-form">
		<label for="color-input">Background :</label>
		<input type="color" id="color-input" name="color-input">
		<button id="buttonBack" type="submit">Enregistrer</button>
	</form>
    <form id="profil-form">
		<label for="file-profil">profile picture :</label>
		<input type="file" id="file-profil" name="file-profil">
	</form>

    <script>
        var theToggle = document.getElementById('toggle');
        // hasClass
        function hasClass(elem, className) {
            return new RegExp(' ' + className + ' ').test(' ' + elem.className + ' ');
        }
        // addClass
        function addClass(elem, className) {
            if (!hasClass(elem, className)) {
                elem.className += ' ' + className;
            }
        }
        // removeClass
        function removeClass(elem, className) {
            var newClass = ' ' + elem.className.replace( /[\t\r\n]/g, ' ') + ' ';
            if (hasClass(elem, className)) {
                while (newClass.indexOf(' ' + className + ' ') >= 0 ) {
                    newClass = newClass.replace(' ' + className + ' ', ' ');
                }
                elem.className = newClass.replace(/^\s+|\s+$/g, '');
            }
        }
        // toggleClass
        function toggleClass(elem, className) {
            var newClass = ' ' + elem.className.replace( /[\t\r\n]/g, " " ) + ' ';
            if (hasClass(elem, className)) {
                while (newClass.indexOf(" " + className + " ") >= 0 ) {
                    newClass = newClass.replace( " " + className + " " , " " );
                }
                elem.className = newClass.replace(/^\s+|\s+$/g, '');
            } else {
                elem.className += ' ' + className;
            }
        }

        theToggle.onclick = function() {
            toggleClass(this, 'on');
            return false;
        }


        // ---------------------------Style---------------------------
		// Récupérer le formulaire de modification de la couleur
		const colorForm = document.getElementById("color-form");

        // Ajouter un événement de soumission au formulaire
        colorForm.addEventListener("submit", (event) => {
            event.preventDefault(); // Empêcher le formulaire de se soumettre

            // Récupérer la couleur saisie par l'utilisateur
            const colorInput = document.getElementById("color-input");
            const newColor = colorInput.value;

            // Enregistrer la couleur dans un cookie associé au nom d'utilisateur
            const nomUtilisateur = getCookieValue("emailUtilisateur");
            if (nomUtilisateur) {
                document.cookie = `couleurFond_${nomUtilisateur}=${newColor}; max-age=3600`;
            }

            // Mettre à jour la couleur de fond du body
            document.body.style.backgroundColor = newColor;
        });

        // Fonction pour récupérer la valeur d'un cookie
        function getCookieValue(cookieName) {
            const cookies = document.cookie.split("; ");
            for (const cookie of cookies) {
                const [name, value] = cookie.split("=");
                if (name === cookieName) {
                    return value;
                }
            }
            return null;
        }

        // Récupérer la couleur du cookie associé au nom d'utilisateur et l'appliquer au body
        const couleurFond = getCookieValue(`couleurFond_${getCookieValue("emailUtilisateur")}`);
        if (couleurFond) {
            document.body.style.backgroundColor = couleurFond;
        }


        // ---------------------------Profil---------------------------
        
        // Obtenez une référence à l'élément input file
        const profilPicture = document.getElementById("profil-form");

        // Ajoutez un gestionnaire d'événements pour détecter lorsque l'utilisateur sélectionne un fichier
        profilPicture.addEventListener("change", function() {
            // Obtenez le fichier sélectionné en accédant à la propriété "files" de l'élément input file
            const selectedFile = inputFile.files[0];
            alert(selectedFile)
            const PictureInput = document.getElementById("file-profil");
            const newPicture = PictureInput.value;

            if (nomUtilisateur) {
                alert("dsdfdf")
                document.cookie = `profilPicture${nomUtilisateur}=${newPicture}; max-age=3600`;
            }
            const profilPicture = getCookieValue(`profilPicture${getCookieValue("emailUtilisateur")}`);
        });
    </script>
</body>
</html>
